services:
  app:
    build:
      context: .
      dockerfile: Dockerfile
      target: development
      args:
        - PORT=${PORT:-3000}
    container_name: pantry-registration-api
    ports:
      - "${PORT:-3000}:${PORT:-3000}"
    environment:
      - NODE_ENV=${NODE_ENV:-development}
      - PORT=${PORT:-3000}
      - DB_HOST=${DB_HOST}
      - DB_PORT=${DB_PORT:-3306}
      - DB_USERNAME=${DB_USERNAME}
      - DB_PASSWORD=${DB_PASSWORD}
      - DB_DATABASE=${DB_DATABASE}
      - DB_PUBLIC_HOST=${DB_PUBLIC_HOST}
      - DB_PUBLIC_PORT=${DB_PUBLIC_PORT:-3306}
      - DB_PUBLIC_USERNAME=${DB_PUBLIC_USERNAME}
      - DB_PUBLIC_PASSWORD=${DB_PUBLIC_PASSWORD}
      - DB_PUBLIC_DATABASE=${DB_PUBLIC_DATABASE}
    volumes:
      - ./src:/app/src
      - ./test:/app/test
      - /app/node_modules
    networks:
      - pantry-network

networks:
  pantry-network:
    driver: bridge